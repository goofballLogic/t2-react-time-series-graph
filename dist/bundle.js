!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("react"),require("recharts"));else if("function"==typeof define&&define.amd)define(["react","recharts"],t);else{var a="object"==typeof exports?t(require("react"),require("recharts")):t(e.react,e.recharts);for(var n in a)("object"==typeof exports?exports:e)[n]=a[n]}}(window,function(e,t){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},a.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=2)}([function(t,a){t.exports=e},function(e,a){e.exports=t},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=({color:e})=>r.a.createElement("span",{className:"swatch",style:{backgroundColor:`rgba(${e})`}},"Â "),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};var c=({payload:e,series:t,formatTooltipDate:a})=>{const n=e&&e[0]&&e[0].payload;if(!n)return null;const{dateWhen:c,runningTotals:o}=n;return r.a.createElement("div",{className:"tooltip"},r.a.createElement("p",{className:"when"},(a||(e=>new Date(e).toLocaleDateString()))(c)),t.map(e=>s({},e,{total:o[e.id]||0})).sort((e,t)=>e.total>t.total?-1:e.total<t.total?1:0).map(e=>r.a.createElement("p",{className:"scores",key:e.id},r.a.createElement("span",{className:"score-name"},r.a.createElement(l,e),e.name),r.a.createElement("span",{className:"score-score"},e.total))))},o=a(1);const i=e=>new Date(e).toLocaleDateString();function m(e,t,a={}){if(e)for(let n of t)e[n]=e[n]||a[n]||[0]}var u=e=>{const{formatTickDate:t,data:a,series:n,endRagged:l,startRagged:s}=e;if(!a)throw new Error("Missing property: data");if(!n)throw new Error("Missing property: series");if(!a.length)return r.a.createElement("div",null,"No data");if(!n.length)return r.a.createElement("div",null,"No series");const u=JSON.parse(JSON.stringify(a));return function(e,t,a,n){if(!n){const a=t.slice(-1)[0]||{};m(a.runningTotals,e),m(a.points,e,a.runningTotals)}if(!a){const a=t[0];m(a.runningTotals,e),m(a.points,e)}}(n.map(e=>e.id),u,s,l),r.a.createElement(o.ResponsiveContainer,{height:400},r.a.createElement(o.LineChart,{data:u,margin:{right:100}},r.a.createElement(o.CartesianGrid,{strokeDasharray:"3 3"}),n.map(e=>r.a.createElement(o.Line,{connectNulls:!0,dataKey:t=>e.id in t.points?t.runningTotals[e.id]:null,key:e.id,stroke:`rgb(${e.color})`,type:"linear",name:e.name})),r.a.createElement(o.Legend,null),r.a.createElement(o.Tooltip,{content:r.a.createElement(c,e),active:!0}),r.a.createElement(o.XAxis,{dataKey:"when",tickFormatter:t||i,type:"number",domain:["dataMin","dataMax"],tickCount:999}),r.a.createElement(o.YAxis,{type:"number",domain:["dataMin - 2","dataMax + 2"],tickCount:10}),r.a.createElement(o.ReferenceLine,{y:0,stroke:"black"})))},d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};const p=e=>new Date(e).toLocaleDateString();var f,h;const E=()=>{};var y=({data:e,series:t,formatTableDate:a,selectWhen:n})=>{return(({data:e,series:t,formatTableDate:a,selectWhen:n})=>r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"When"),t.map(e=>r.a.createElement("th",{key:e.id},r.a.createElement(l,e),e.name)))),r.a.createElement("tbody",null,e.map(e=>[r.a.createElement("tr",{key:e.when,onClick:n.bind(void 0,e.when),className:`master ${e.selected?"selected":""}`},r.a.createElement("td",{rowSpan:"2"},a(e.when)),t.map(t=>r.a.createElement("td",{key:t.id,className:`total ${((e,t)=>e in t.points?`significant ${f=t.points[e],h=f.reduce((e,t)=>e+t),h>0?"up":h<0?"down":""}`:"")(t.id,e)}`},e.runningTotals[t.id]))),r.a.createElement("tr",{key:`detail-${e.when}`,className:`detail ${e.selected?"selected":""}`},r.a.createElement("td",{colSpan:t.length},r.a.createElement("div",null,r.a.createElement("table",null,r.a.createElement("tbody",null,e.events.map(e=>d({s:t.find(t=>t.id===e.id)},e)).filter(e=>e.s).map((e,t)=>r.a.createElement("tr",{key:t},r.a.createElement("td",null,r.a.createElement(l,e.s),e.s.name),r.a.createElement("td",{className:e.score<0?"down":e.score>0?"up":""},e.score),r.a.createElement("td",null,e.description))))))))]))))({data:e.slice(0).sort((e,t)=>e.when>t.when?-1:e.when<t.when?1:0),series:t,formatTableDate:a=a||p,selectWhen:n=n||E})},v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};function g(e,t,a){let n=0,r=[],l=0,s=[];for(let c=0;c<e.length;c++)t(e[c])?(n++,r=r.concat(a(e[c])),n>=l&&(l=n,s=r.slice(0))):(n=0,r=[]);return{max:l,included:s}}const b=e=>e.slice(0).sort((e,t)=>t.streak.max-e.streak.max),w=e=>{const t=Math.max.apply(Math,e.map(e=>e.streak.max));return e.map(e=>v({},e,{percentage:0===e.streak.max?0:100*e.streak.max/t}))};function k(e,t){const a=e.map(e=>({id:e.id,series:e,streak:g(t.filter(t=>e.id in t.points),t=>t.points[e.id]>=0,t=>t.events.filter(t=>t.id===e.id))}));return w(b(a))}var O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};const T=({series:e,data:t,strategy:a})=>r.a.createElement("table",null,r.a.createElement("tbody",null,a(e,t).map(e=>r.a.createElement("tr",{key:e.id},r.a.createElement("td",{className:"name"},r.a.createElement(l,e.series),e.series.name),r.a.createElement("td",{className:"visual-sizer"},r.a.createElement("span",{className:"up",style:{width:e.percentage+"%"}})),r.a.createElement("td",{className:"length"},e.streak.max)))));var x=e=>r.a.createElement("section",{className:"streaks"},(e.strategy||(e=>T(O({},e,{strategy:k}))))(e)),N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};const j=()=>{};var D=({events:e,series:t,formatTableDate:a,selectEvent:n})=>{if(!e)return null;return(({events:e,series:t,formatTableDate:a,selectWhen:n})=>r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"When"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Score"),r.a.createElement("th",null,"Description"))),r.a.createElement("tbody",null,e.map(e=>N({},e,{s:t.find(t=>t.id===e.id)})).filter(e=>e.s).map(e=>r.a.createElement("tr",{key:e.key},r.a.createElement("td",null,a(new Date(e.when))),r.a.createElement("td",null,r.a.createElement(l,e.s),e.s.name),r.a.createElement("td",{className:e.score<0?"down":e.score>0?"up":""},e.score),r.a.createElement("td",null,e.description))))))({events:e.slice(0).sort((e,t)=>e.when>t.when?-1:e.when<t.when?1:0).map((e,t)=>N({},e,{key:e.key||t})),series:t,formatTableDate:a=a||defaultFormatTableDate,selectEvent:n=n||j})},S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};function M(e,t,a){const n=e[t]||[];return n.push(a),S({},e,{[t]:n})}const P=(e,t,a)=>S({},e,{points:e.events.reduce((e,n)=>M(e,n[t],n[a]),{})}),K=(e,t)=>{const{points:a}=e;for(let e of Object.keys(a)){const n=a[e].reduce((e,t)=>e+t,0),r=t[e]||0;t[e]=r+n}return S({},e,{runningTotals:S({},t)})};function W(e,t){t=S({whenKey:"when",valueKey:"score",idKey:"id"},t);const{whenKey:a,valueKey:n,idKey:r}=t,l=e.reduce((e,t)=>M(e,t[a],t),{});let s={};return Object.keys(l).sort().map(e=>K(P({when:new Date(e).valueOf(),dateWhen:new Date(e),events:l[e]},r,n),s))}a.d(t,"TimeSeriesGraph",function(){return u}),a.d(t,"TimeSeriesTooltip",function(){return c}),a.d(t,"TimeSeriesTable",function(){return y}),a.d(t,"TimeSeriesStreaks",function(){return x}),a.d(t,"TimeSeriesEventTable",function(){return D}),a.d(t,"accumulate",function(){return W});t.default=u}])});